# Requirements for RunPod Serverless Inference
# Excludes training-only packages to reduce image size
# Based on Hunyuan3D-2.1 requirements.txt

--extra-index-url https://download.pytorch.org/whl/cu121
--extra-index-url https://mirrors.cloud.tencent.com/pypi/simple/
--extra-index-url https://mirrors.aliyun.com/pypi/simple

# PyTorch (pinned to prevent dependency upgrades)
# MUST match version installed in Dockerfile and custom_rasterizer wheel
torch==2.5.1+cu121
torchvision==0.20.1+cu121
torchaudio==2.5.1+cu121

# Build Tools
ninja==1.11.1.1
pybind11==2.13.4

# Core ML/Deep Learning
transformers==4.46.0
diffusers==0.30.0
accelerate==1.1.1
# pytorch-lightning is required by Hunyuan3D even for inference
pytorch-lightning==2.2.0
huggingface-hub==0.30.2
safetensors==0.4.4

# Scientific Computing
numpy==1.26.4
scipy==1.14.1
einops==0.8.0
pandas==2.2.2

# Computer Vision & Image Processing
opencv-python==4.10.0.84
imageio==2.36.0
scikit-image==0.24.0
rembg==2.0.65
# realesrgan==0.3.0  # EXCLUDED: requires basicsr>=1.4.2 which has no Python 3.12 wheels
# basicsr==1.3.3.3   # EXCLUDED: conflict with realesrgan dependency
# NOTE: Use onnx_upscaler.py instead - ONNX model at weights/realesrgan_x4plus.onnx

# 3D Mesh Processing
trimesh==4.4.7
pymeshlab==2023.12.post3
pygltflib==1.16.3
xatlas==0.0.9
open3d==0.19.0

# Configuration Management
omegaconf==2.3.0
pyyaml==6.0.2
configargparse==1.7

# Web Framework
# gradio==5.33.0  # EXCLUDED: web UI not needed for serverless API
fastapi==0.115.12
uvicorn==0.34.3

# Utilities
tqdm==4.66.5
psutil==6.0.0

# S3 Storage (for large output files)
boto3>=1.26.0

# GPU Computing (requires CUDA)
cupy-cuda12x==13.4.1

# bpy==4.0  # EXCLUDED: requires Blender install, handled separately

# ONNX Runtime
# Use onnxruntime-gpu for CUDA support (CUDAExecutionProvider)
# This enables GPU acceleration for the ONNX-based RealESRGAN upscaler
# NOTE: 1.18.0+ required for CUDA 12 support (1.17.0 only supports CUDA 11)
onnxruntime-gpu==1.19.2
torchmetrics==1.6.0

pydantic==2.10.6

timm
pythreejs
torchdiffeq
# deepspeed  # EXCLUDED: distributed training only
